// Code generated by BobGen psql v0.40.2. DO NOT EDIT.
// This file is meant to be re-generated in place and/or deleted at any time.

package models

import (
	"context"
	"time"

	"github.com/aarondl/opt/null"
	"github.com/shopspring/decimal"
	"github.com/stephenafamo/bob"
	"github.com/stephenafamo/bob/dialect/psql"
	"github.com/stephenafamo/bob/expr"
)

// IotAlertEvent is an object representing the database table.
type IotAlertEvent struct {
	Time         time.Time                 `db:"time" `
	DeviceID     string                    `db:"device_id" `
	AlertType    string                    `db:"alert_type" `
	Severity     string                    `db:"severity" `
	Message      string                    `db:"message" `
	CurrentValue null.Val[decimal.Decimal] `db:"current_value" `
}

// IotAlertEventSlice is an alias for a slice of pointers to IotAlertEvent.
// This should almost always be used instead of []*IotAlertEvent.
type IotAlertEventSlice []*IotAlertEvent

// IotAlertEvents contains methods to work with the iot_alert_events view
var IotAlertEvents = psql.NewViewx[*IotAlertEvent, IotAlertEventSlice]("", "iot_alert_events", buildIotAlertEventColumns("iot_alert_events"))

// IotAlertEventsQuery is a query on the iot_alert_events view
type IotAlertEventsQuery = *psql.ViewQuery[*IotAlertEvent, IotAlertEventSlice]

func buildIotAlertEventColumns(alias string) iotAlertEventColumns {
	return iotAlertEventColumns{
		ColumnsExpr: expr.NewColumnsExpr(
			"time", "device_id", "alert_type", "severity", "message", "current_value",
		).WithParent("iot_alert_events"),
		tableAlias:   alias,
		Time:         psql.Quote(alias, "time"),
		DeviceID:     psql.Quote(alias, "device_id"),
		AlertType:    psql.Quote(alias, "alert_type"),
		Severity:     psql.Quote(alias, "severity"),
		Message:      psql.Quote(alias, "message"),
		CurrentValue: psql.Quote(alias, "current_value"),
	}
}

type iotAlertEventColumns struct {
	expr.ColumnsExpr
	tableAlias   string
	Time         psql.Expression
	DeviceID     psql.Expression
	AlertType    psql.Expression
	Severity     psql.Expression
	Message      psql.Expression
	CurrentValue psql.Expression
}

func (c iotAlertEventColumns) Alias() string {
	return c.tableAlias
}

func (iotAlertEventColumns) AliasedAs(alias string) iotAlertEventColumns {
	return buildIotAlertEventColumns(alias)
}

// AfterQueryHook is called after IotAlertEvent is retrieved from the database
func (o *IotAlertEvent) AfterQueryHook(ctx context.Context, exec bob.Executor, queryType bob.QueryType) error {
	var err error

	switch queryType {
	case bob.QueryTypeSelect:
		ctx, err = IotAlertEvents.AfterSelectHooks.RunHooks(ctx, exec, IotAlertEventSlice{o})
	}

	return err
}

// AfterQueryHook is called after IotAlertEventSlice is retrieved from the database
func (o IotAlertEventSlice) AfterQueryHook(ctx context.Context, exec bob.Executor, queryType bob.QueryType) error {
	var err error

	switch queryType {
	case bob.QueryTypeSelect:
		ctx, err = IotAlertEvents.AfterSelectHooks.RunHooks(ctx, exec, o)
	}

	return err
}

type iotAlertEventWhere[Q psql.Filterable] struct {
	Time         psql.WhereMod[Q, time.Time]
	DeviceID     psql.WhereMod[Q, string]
	AlertType    psql.WhereMod[Q, string]
	Severity     psql.WhereMod[Q, string]
	Message      psql.WhereMod[Q, string]
	CurrentValue psql.WhereNullMod[Q, decimal.Decimal]
}

func (iotAlertEventWhere[Q]) AliasedAs(alias string) iotAlertEventWhere[Q] {
	return buildIotAlertEventWhere[Q](buildIotAlertEventColumns(alias))
}

func buildIotAlertEventWhere[Q psql.Filterable](cols iotAlertEventColumns) iotAlertEventWhere[Q] {
	return iotAlertEventWhere[Q]{
		Time:         psql.Where[Q, time.Time](cols.Time),
		DeviceID:     psql.Where[Q, string](cols.DeviceID),
		AlertType:    psql.Where[Q, string](cols.AlertType),
		Severity:     psql.Where[Q, string](cols.Severity),
		Message:      psql.Where[Q, string](cols.Message),
		CurrentValue: psql.WhereNull[Q, decimal.Decimal](cols.CurrentValue),
	}
}
